#!/bin/bash
# This script is used to find the raw photos which are not converted

# e.g:
#   bash ~/src/dotfiles/bin/footage_find_non_converted ~/data/footage ~/data/footage_converted '.*_09.*CR3'

SOURCE_ROOT="$1"
DESTINATION_ROOT="$2"
PATH_REGEX="$3"

for file_path in $(find $SOURCE_ROOT -type f -regex "$PATH_REGEX"); do
    FILE_DIRECTORY=$(dirname $file_path)
    filename=$(basename $file_path)
    filename_without_ext="${filename%.*}"
    RELATIVE_PATH_TO_SOURCE_ROOT=${FILE_DIRECTORY#"$SOURCE_ROOT"}
    DEST_FILE_DIRECTORY="${DESTINATION_ROOT}$RELATIVE_PATH_TO_SOURCE_ROOT"
    DEST_FILE_PATH="${DEST_FILE_DIRECTORY}/${filename_without_ext}.jpg"
    if [[ -f $DEST_FILE_PATH ]] ; then
      #echo "Converted File found for :" $file_path
      :
    else
      echo "Converted File not found for :" $file_path
    fi
done
